<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/felixge/node-dirty#readme"

    >dirty (v1.1.0)</a>
</h1>
<h4>A tiny & fast key value store with append-only disk log. Ideal for apps with < 1 million records.</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.dirty">module dirty</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.dirty">
            function <span class="apidocSignatureSpan"></span>dirty
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty">
            function <span class="apidocSignatureSpan">dirty.</span>Dirty
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.super_">
            function <span class="apidocSignatureSpan">dirty.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">dirty.</span>Dirty.prototype</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.dirty.Dirty">module dirty.Dirty</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty.Dirty">
            function <span class="apidocSignatureSpan">dirty.</span>Dirty
            <span class="apidocSignatureSpan">(path)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty.super_">
            function <span class="apidocSignatureSpan">dirty.Dirty.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.dirty.Dirty.prototype">module dirty.Dirty.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty.prototype._flush">
            function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>_flush
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty.prototype._load">
            function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>_load
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty.prototype._maybeFlush">
            function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>_maybeFlush
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty.prototype._writeDrain">
            function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>_writeDrain
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty.prototype.close">
            function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty.prototype.forEach">
            function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>forEach
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty.prototype.get">
            function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>get
            <span class="apidocSignatureSpan">(key)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty.prototype.rm">
            function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>rm
            <span class="apidocSignatureSpan">(key, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty.prototype.set">
            function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>set
            <span class="apidocSignatureSpan">(key, val, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty.prototype.size">
            function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>size
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.dirty.Dirty.prototype.update">
            function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>update
            <span class="apidocSignatureSpan">(key, updater, cb)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.dirty" id="apidoc.module.dirty">module dirty</a></h1>


    <h2>
        <a href="#apidoc.element.dirty.dirty" id="apidoc.element.dirty.dirty">
        function <span class="apidocSignatureSpan"></span>dirty
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dirty = function (path) {
  if (!(this instanceof Dirty)) return new Dirty(path);

  EventEmitter.call(this);

  this.path = path;
  this.writeBundle = 1000;

  this._docs = {};
  this._keys = [];
  this._queue = [];
  this._readStream = null;
  this._writeStream = null;
  this._fdRead = null;
  this._fdWrite = null;

  this._load();
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dirty.Dirty" id="apidoc.element.dirty.Dirty">
        function <span class="apidocSignatureSpan">dirty.</span>Dirty
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Dirty = function (path) {
  if (!(this instanceof Dirty)) return new Dirty(path);

  EventEmitter.call(this);

  this.path = path;
  this.writeBundle = 1000;

  this._docs = {};
  this._keys = [];
  this._queue = [];
  this._readStream = null;
  this._writeStream = null;
  this._fdRead = null;
  this._fdWrite = null;

  this._load();
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Creates a new dirty database. If `path` does not exist yet, it is created. You
can also omit the `path` if you don&#x27;t want disk persistence (useful for testing).

The constructor can be invoked in multiple ways:

```javascript
require(&#x27;dirty&#x27;)(&#x27;my.db&#x27;);
require(&#x27;dirty&#x27;).<span class="apidocCodeKeywordSpan">Dirty</span>(&#x27;my.db&#x27;);
new (require(&#x27;dirty&#x27;))(&#x27;my.db&#x27;);
new (require(&#x27;dirty&#x27;).Dirty)(&#x27;my.db&#x27;);
```
### dirty.path

The path of the dirty database.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dirty.super_" id="apidoc.element.dirty.super_">
        function <span class="apidocSignatureSpan">dirty.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.dirty.Dirty" id="apidoc.module.dirty.Dirty">module dirty.Dirty</a></h1>


    <h2>
        <a href="#apidoc.element.dirty.Dirty.Dirty" id="apidoc.element.dirty.Dirty.Dirty">
        function <span class="apidocSignatureSpan">dirty.</span>Dirty
        <span class="apidocSignatureSpan">(path)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Dirty = function (path) {
  if (!(this instanceof Dirty)) return new Dirty(path);

  EventEmitter.call(this);

  this.path = path;
  this.writeBundle = 1000;

  this._docs = {};
  this._keys = [];
  this._queue = [];
  this._readStream = null;
  this._writeStream = null;
  this._fdRead = null;
  this._fdWrite = null;

  this._load();
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Creates a new dirty database. If `path` does not exist yet, it is created. You
can also omit the `path` if you don&#x27;t want disk persistence (useful for testing).

The constructor can be invoked in multiple ways:

```javascript
require(&#x27;dirty&#x27;)(&#x27;my.db&#x27;);
require(&#x27;dirty&#x27;).<span class="apidocCodeKeywordSpan">Dirty</span>(&#x27;my.db&#x27;);
new (require(&#x27;dirty&#x27;))(&#x27;my.db&#x27;);
new (require(&#x27;dirty&#x27;).Dirty)(&#x27;my.db&#x27;);
```
### dirty.path

The path of the dirty database.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dirty.Dirty.super_" id="apidoc.element.dirty.Dirty.super_">
        function <span class="apidocSignatureSpan">dirty.Dirty.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.dirty.Dirty.prototype" id="apidoc.module.dirty.Dirty.prototype">module dirty.Dirty.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.dirty.Dirty.prototype._flush" id="apidoc.element.dirty.Dirty.prototype._flush">
        function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>_flush
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_flush = function () {
  var self = this,
      length = this._queue.length,
      bundleLength = 0,
      bundleStr = &#x27;&#x27;,
      key,
      cbs = [];

  this.flushing = true;

  function callbacks(err, cbs) {
    while (cbs.length) {
      cbs.shift()(err);
    }
  }

  for (var i = 0; i &#x3c; length; i++) {
    key = this._queue[i];
    if (Array.isArray(key)) {
      cbs.push(key[1]);
      key = key[0];
    }

    bundleStr += JSON.stringify({key: key, val: this._docs[key]})+&#x27;\n&#x27;;
    bundleLength++;

    if (bundleLength &#x3c; this.writeBundle &#x26;&#x26; i &#x3c; length - 1) {
      continue;
    }

    (function(cbs) {
      var isDrained;

      if (!self.path) {
        process.nextTick(function() {
          callbacks(null, cbs);
          self._writeDrain();
        });
        return;
      }

      isDrained = self._writeStream.write(bundleStr, function(err) {
        if (isDrained) {
          self._writeDrain();
        }

        if (!cbs.length &#x26;&#x26; err) {
          self.emit(&#x27;error&#x27;, err);
          return;
        }

        callbacks(err, cbs);
      });

    })(cbs);

    bundleStr = &#x27;&#x27;;
    bundleLength = 0;
    cbs = [];
  }

  this._queue = [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

Dirty.prototype._maybeFlush = function() {
if (this.flushing || !this._queue.length) {
  return;
}

this.<span class="apidocCodeKeywordSpan">_flush</span>();
};

Dirty.prototype._flush = function() {
var self = this,
    length = this._queue.length,
    bundleLength = 0,
    bundleStr = &#x27;&#x27;,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dirty.Dirty.prototype._load" id="apidoc.element.dirty.Dirty.prototype._load">
        function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>_load
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_load = function () {
  var self = this, buffer = &#x27;&#x27;, length = 0;

  if (!this.path) {
    process.nextTick(function() {
      self.emit(&#x27;load&#x27;, 0);
    });
    return;
  }

  this._readStream = fs.createReadStream(this.path, {
    encoding: &#x27;utf-8&#x27;,
    flags: &#x27;r&#x27;
  });

  this._readStream
    .on(&#x27;error&#x27;, function(err) {
      if (err.code === &#x27;ENOENT&#x27;) {
        self.emit(&#x27;load&#x27;, 0);
        return;
      }

      self.emit(&#x27;error&#x27;, err);
    })
    .on(&#x27;data&#x27;, function(chunk) {
      buffer += chunk;
      if (chunk.lastIndexOf(&#x27;\n&#x27;) == -1) return;
      var arr = buffer.split(&#x27;\n&#x27;);
      buffer = arr.pop();
      arr.forEach(function(rowStr) {
        if (!rowStr) {
          self.emit(&#x27;error&#x27;, new Error(&#x27;Empty lines never appear in a healthy database&#x27;));
          return;
        }

        var row;
        try {
          row = JSON.parse(rowStr);
          if (!(&#x27;key&#x27; in row)) {
            throw new Error();
          }
        } catch (e) {
          self.emit(&#x27;error&#x27;, new Error(&#x27;Could not load corrupted row: &#x27;+rowStr));
          return &#x27;&#x27;;
        }

        if (row.val === undefined) {
          if (row.key in self._docs) {
            length--;
          }
          delete self._docs[row.key];
        } else {
          if (!(row.key in self._docs)) {
            if(self._keys.indexOf(row.key) === -1){
            	self._keys.push(row.key);
            }
            length++;
          }
          self._docs[row.key] = row.val;
        }
        return &#x27;&#x27;;
      });
    })
    .on(&#x27;end&#x27;, function() {
      if (buffer.length) {
        self.emit(&#x27;error&#x27;, new Error(&#x27;Corrupted row at the end of the db: &#x27;+buffer));
      }
      self.emit(&#x27;load&#x27;, length);
    })
    .on(&#x27;open&#x27;, function(fd) {
    	self._fdRead = fd;
    });

  this._writeStream = fs.createWriteStream(this.path, {
    encoding: &#x27;utf-8&#x27;,
    flags: &#x27;a&#x27;
  });

  this._writeStream.on(&#x27;drain&#x27;, function() {
    self._writeDrain();
  });

  this._writeStream.on(&#x27;open&#x27;, function(fd) {
	  self._fdWrite = fd;
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  this._keys = [];
  this._queue = [];
  this._readStream = null;
  this._writeStream = null;
  this._fdRead = null;
  this._fdWrite = null;

  this.<span class="apidocCodeKeywordSpan">_load</span>();
  return this;
};

util.inherits(Dirty, EventEmitter);
Dirty.Dirty = Dirty;
module.exports = Dirty;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dirty.Dirty.prototype._maybeFlush" id="apidoc.element.dirty.Dirty.prototype._maybeFlush">
        function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>_maybeFlush
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_maybeFlush = function () {
  if (this.flushing || !this._queue.length) {
    return;
  }

  this._flush();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  if (!cb) {
    this._queue.push(key);
  } else {
    this._queue.push([key, cb]);
  }

  this.<span class="apidocCodeKeywordSpan">_maybeFlush</span>();
};

/**
* Get the value stored at a key in the database
* This is synchronous since a cache is maintained in-memory
*/
Dirty.prototype.get = function(key) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dirty.Dirty.prototype._writeDrain" id="apidoc.element.dirty.Dirty.prototype._writeDrain">
        function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>_writeDrain
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_writeDrain = function () {
  this.flushing = false;

  if (!this._queue.length) {
    this.emit(&#x27;drain&#x27;);
  } else {
    this._maybeFlush();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  this._writeStream = fs.createWriteStream(this.path, {
    encoding: &#x27;utf-8&#x27;,
    flags: &#x27;a&#x27;
  });

  this._writeStream.on(&#x27;drain&#x27;, function() {
    self.<span class="apidocCodeKeywordSpan">_writeDrain</span>();
  });

  this._writeStream.on(&#x27;open&#x27;, function(fd) {
	  self._fdWrite = fd;
  });
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dirty.Dirty.prototype.close" id="apidoc.element.dirty.Dirty.prototype.close">
        function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function () {

  if (!this.path) {
    return;
  }

  this._maybeFlush();

  var self = this;
  if (this._fdRead) {
    fs.close(this._fdRead, function() {
      self.emit(&#x27;read_close&#x27;);
    });
  }
  if (this._fdWrite) {
    fs.close(this._fdWrite, function() {
      self.emit(&#x27;write_close&#x27;);
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Calls the given `fn` function for every document in the database. The passed
arguments are `key` and `val`. You can return `false` to abort a query (useful
if you are only interested in a limited number of records).

This function is blocking and runs at ~4 Mhz.

### dirty.<span class="apidocCodeKeywordSpan">close</span>()

Close the dirty db file handle.

### dirty event: &#x27;load&#x27; (length)

Emitted once the database file has finished loading. It is not safe to access
records before this event fires. Writing records however should be fine.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dirty.Dirty.prototype.forEach" id="apidoc.element.dirty.Dirty.prototype.forEach">
        function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>forEach
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">forEach = function (fn) {

  for (var i = 0; i &#x3c; this._keys.length; i++) {
    var key = this._keys[i];
    if (fn(key, this._docs[key]) === false) {
      break;
    }
  }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  db.set(&#x27;john&#x27;, {eyes: &#x27;blue&#x27;});
  console.log(&#x27;Added john, he has %s eyes.&#x27;, db.get(&#x27;john&#x27;).eyes);

  db.set(&#x27;bob&#x27;, {eyes: &#x27;brown&#x27;}, function() {
    console.log(&#x27;User bob is now saved on disk.&#x27;)
  });

  db.<span class="apidocCodeKeywordSpan">forEach</span>(function(key, val) {
    console.log(&#x27;Found key: %s, val: %j&#x27;, key, val);
  });
});

db.on(&#x27;drain&#x27;, function() {
  console.log(&#x27;All records are saved on disk now.&#x27;);
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dirty.Dirty.prototype.get" id="apidoc.element.dirty.Dirty.prototype.get">
        function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>get
        <span class="apidocSignatureSpan">(key)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function (key) {
  return this._docs[key];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

```javascript
  var dirty = require(&#x27;dirty&#x27;);
  var db = dirty(&#x27;user.db&#x27;);

  db.on(&#x27;load&#x27;, function() {
db.set(&#x27;john&#x27;, {eyes: &#x27;blue&#x27;});
console.log(&#x27;Added john, he has %s eyes.&#x27;, db.<span class="apidocCodeKeywordSpan">get</span>(&#x27;john&#x27;).eyes);

db.set(&#x27;bob&#x27;, {eyes: &#x27;brown&#x27;}, function() {
  console.log(&#x27;User bob is now saved on disk.&#x27;)
});

db.forEach(function(key, val) {
  console.log(&#x27;Found key: %s, val: %j&#x27;, key, val);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dirty.Dirty.prototype.rm" id="apidoc.element.dirty.Dirty.prototype.rm">
        function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>rm
        <span class="apidocSignatureSpan">(key, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rm = function (key, cb) {
  this.set(key, undefined, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

`val` can be any JSON-serializable type, it does not have to be an object.

### dirty.get(key)

Retrieves the value for the given `key`.

### dirty.<span class="apidocCodeKeywordSpan">rm</span>(key, cb)

Removes the record with the given `key`. This is identical to setting the `key`&#x27;s value
to `undefined`.

### dirty.update(key, updater, [cb])

Updates the record of the given `key` with the given `updater` which is a function
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dirty.Dirty.prototype.set" id="apidoc.element.dirty.Dirty.prototype.set">
        function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>set
        <span class="apidocSignatureSpan">(key, val, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">set = function (key, val, cb) {
  if (val === undefined) {
    this._keys.splice(this._keys.indexOf(key), 1);
    delete this._docs[key];
  } else {
    if (this._keys.indexOf(key) === -1) {
      this._keys.push(key);
    }
    this._docs[key] = val;
  }

  if (!cb) {
    this._queue.push(key);
  } else {
    this._queue.push([key, cb]);
  }

  this._maybeFlush();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
## Tutorial

```javascript
  var dirty = require(&#x27;dirty&#x27;);
  var db = dirty(&#x27;user.db&#x27;);

  db.on(&#x27;load&#x27;, function() {
db.<span class="apidocCodeKeywordSpan">set</span>(&#x27;john&#x27;, {eyes: &#x27;blue&#x27;});
console.log(&#x27;Added john, he has %s eyes.&#x27;, db.get(&#x27;john&#x27;).eyes);

db.set(&#x27;bob&#x27;, {eyes: &#x27;brown&#x27;}, function() {
  console.log(&#x27;User bob is now saved on disk.&#x27;)
});

db.forEach(function(key, val) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dirty.Dirty.prototype.size" id="apidoc.element.dirty.Dirty.prototype.size">
        function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>size
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">size = function () {
  return this._keys.length;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var db = dirty();

db.set(1, {test: &#x27;foo&#x27;});
db.set(2, {test: &#x27;bar&#x27;});
db.set(3, {test: &#x27;foobar&#x27;});

it(&#x27;should be equal to number of keys set&#x27;, function() {
  assert.equal(db.<span class="apidocCodeKeywordSpan">size</span>(), 3);
});
});

describe(&#x27;test-chaining-of-constructor&#x27;, function() {
var file = config.TMP_PATH + &#x27;/chain.dirty&#x27;;
fs.existsSync(file) &#x26;&#x26; fs.unlinkSync(file);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.dirty.Dirty.prototype.update" id="apidoc.element.dirty.Dirty.prototype.update">
        function <span class="apidocSignatureSpan">dirty.Dirty.prototype.</span>update
        <span class="apidocSignatureSpan">(key, updater, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">update = function (key, updater, cb) {
  this.set(key, updater(this.get(key)), cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Retrieves the value for the given `key`.

### dirty.rm(key, cb)

Removes the record with the given `key`. This is identical to setting the `key`&#x27;s value
to `undefined`.

### dirty.<span class="apidocCodeKeywordSpan">update</span>(key, updater, [cb])

Updates the record of the given `key` with the given `updater` which is a function
that is passed the current value of the key.

The optional `cb` callback is passed to `dirty.set`.

### dirty.forEach(fn)
...</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
